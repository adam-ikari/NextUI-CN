# Test Makefile for NextUI UI Simulator

# Platform configuration - use desktop platform for CI
PLATFORM ?= desktop

# Compiler settings
CC ?= gcc
CFLAGS += -Wall -Wextra -O2
CFLAGS += -DPLATFORM="$(PLATFORM)"

# SDL configuration
SDL_CONFIG ?= sdl2-config
SDL_CFLAGS = $(shell $(SDL_CONFIG) --cflags)
SDL_LIBS = $(shell $(SDL_CONFIG) --libs)

# Include paths
INCDIR = -I. -I../common/ -I../../$(PLATFORM)/platform/ -I../../i18n/
CFLAGS += $(SDL_CFLAGS)
CFLAGS += $(INCDIR)

# Linker settings
LDFLAGS += $(SDL_LIBS)
LDFLAGS += -lpthread -ldl -lm -lz

# Simulator source files
SIMULATOR_SOURCES = simulator.c
SIMULATOR_TARGET = nextui_simulator

# Output directory
TEST_OUTPUT_DIR = test_output

.PHONY: all clean run help

all: $(SIMULATOR_TARGET)
	@echo "NextUI UI Simulator built successfully"
	@echo "Run: ./$(SIMULATOR_TARGET)"

$(SIMULATOR_TARGET): $(SIMULATOR_SOURCES)
	$(CC) $(CFLAGS) $(SIMULATOR_SOURCES) -o $(SIMULATOR_TARGET) $(LDFLAGS)
	@echo "Built: $(SIMULATOR_TARGET)"

run: $(SIMULATOR_TARGET)
	@mkdir -p $(TEST_OUTPUT_DIR)
	./$(SIMULATOR_TARGET)

clean:
	rm -f $(SIMULATOR_TARGET)
	rm -rf $(TEST_OUTPUT_DIR)

help:
	@echo "NextUI UI Simulator"
	@echo ""
	@echo "Targets:"
	@echo "  all    Build the UI simulator"
	@echo "  run    Run the UI simulator"
	@echo "  clean  Clean build artifacts"
	@echo "  help   Show this help message"
	@echo ""
	@echo "Usage:"
	@echo "  make -f makefile.test [target]"
	@echo ""
	@echo "The simulator allows you to test NextUI UI components"
	@echo "on desktop without needing actual hardware."